<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enlitens AI - Advanced Monitoring Dashboard</title>
  <link rel="stylesheet" href="/static/dashboard.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="dashboard-grid">
    <!-- Main Panel -->
    <div class="main-panel">
      <!-- Header -->
      <div class="card">
        <h1 style="margin: 0; color: var(--color-accent);">âœ… Enlitens AI Monitoring Dashboard</h1>
        <p style="margin: 0.5rem 0; color: var(--text-secondary);" id="status">Connecting...</p>
      </div>

      <!-- Metrics -->
      <div class="card">
        <h2>System Metrics</h2>
        <div class="metrics-grid">
          <div class="metric docs">
            <div class="metric-label">Documents Processed</div>
            <div class="metric-value" id="metric-docs">0</div>
            <div class="metric-label" id="metric-docs-total">of 0 total</div>
          </div>
          <div class="metric errors">
            <div class="metric-label">Errors</div>
            <div class="metric-value" id="metric-errors">0</div>
            <div class="metric-label" id="metric-errors-status">All clear</div>
          </div>
          <div class="metric warnings">
            <div class="metric-label">Warnings</div>
            <div class="metric-value" id="metric-warnings">0</div>
            <div class="metric-label">Monitoring</div>
          </div>
          <div class="metric quality">
            <div class="metric-label">Quality Score</div>
            <div class="metric-value" id="metric-quality">--</div>
            <div class="metric-label" id="metric-quality-status">Analyzing</div>
          </div>
        </div>
      </div>

      <!-- Charts -->
      <div class="card">
        <h2>Processing Analytics</h2>
        <div class="tabs">
          <div class="tab active" onclick="switchTab(event, 'chart-progress')">Progress</div>
          <div class="tab" onclick="switchTab(event, 'chart-quality')">Quality</div>
          <div class="tab" onclick="switchTab(event, 'chart-agents')">Agents</div>
        </div>
        <div id="chart-progress" class="tab-content active">
          <div class="chart-container">
            <canvas id="progressChart"></canvas>
          </div>
        </div>
        <div id="chart-quality" class="tab-content">
          <div class="chart-container">
            <canvas id="qualityChart"></canvas>
          </div>
        </div>
        <div id="chart-agents" class="tab-content">
          <div class="chart-container">
            <canvas id="agentsChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Logs -->
      <div class="card">
        <h2>Live Processing Logs</h2>
        <div class="controls">
          <button class="btn btn-secondary" onclick="clearLogs()">Clear</button>
          <button class="btn btn-secondary" onclick="exportLogs()">Export</button>
          <button class="btn btn-secondary" onclick="togglePause()" id="pause-btn">Pause</button>
        </div>
        <div class="logs-container" id="logs"></div>
      </div>
    </div>

    <!-- Right Panel -->
    <div class="right-panel">
      <!-- Current Document -->
      <div class="card">
        <h3>Current Document</h3>
        <div id="current-doc">Initializing...</div>
      </div>

      <!-- Client Profile Quality Metrics -->
      <div class="card">
        <h3>Client Profile Quality</h3>
        <div class="profile-metrics-grid">
          <div class="profile-metric">
            <div class="profile-metric-label">Unique Localities</div>
            <div class="profile-metric-value" id="profile-localities-count">0</div>
            <div class="profile-metric-sub" id="profile-localities-list">Awaiting metricsâ€¦</div>
          </div>
          <div class="profile-metric">
            <div class="profile-metric-label">External Sources</div>
            <div class="profile-metric-value" id="profile-external-count">0</div>
            <div class="profile-metric-sub" id="profile-external-list">[Ext #] citations pending</div>
          </div>
          <div class="profile-metric">
            <div class="profile-metric-label">Prediction Errors</div>
            <div class="profile-metric-value" id="profile-prediction-errors">0</div>
            <div class="profile-metric-sub" id="profile-prediction-errors-breakdown">Per-profile breakdown pending</div>
          </div>
          <div class="profile-metric">
            <div class="profile-metric-label">Disclaimer Status</div>
            <div class="profile-metric-value" id="profile-disclaimer-status">--</div>
            <div class="profile-metric-sub" id="profile-disclaimer-details">Fictional disclaimer review queue</div>
          </div>
        </div>
        <div class="profile-alerts" id="profile-alerts">
          <div class="profile-alert profile-alert--pending">Awaiting client profile metricsâ€¦</div>
        </div>
      </div>

      <!-- AI Chat Assistant -->
      <div class="card">
        <h3>ðŸ¤– AI Assistant</h3>
        <p style="font-size: 0.875rem; color: var(--text-secondary);">Ask questions about logs, quality, and progress</p>
        <div class="chat-container">
          <div class="chat-messages" id="chat-messages">
            <div class="message assistant">
              <strong>Assistant</strong>
              <p>Hello! I'm monitoring your processing pipeline. Ask me about:
              <ul>
                <li>Current document status</li>
                <li>Quality metrics and issues</li>
                <li>Error analysis</li>
                <li>Processing suggestions</li>
              </ul>
              </p>
            </div>
          </div>
          <div class="chat-input">
            <input type="text" id="chat-input" placeholder="Ask about your processing..." onkeypress="if(event.key==='Enter')sendMessage()">
            <button onclick="sendMessage()">Send</button>
          </div>
        </div>
      </div>

      <!-- JSON Output Viewer -->
      <div class="card">
        <h3>Latest JSON Output</h3>
        <div class="controls">
          <button class="btn btn-secondary" onclick="refreshJSON()">Refresh</button>
          <button class="btn btn-secondary" onclick="downloadJSON()">Download</button>
        </div>
        <div class="json-viewer" id="json-viewer">Loading...</div>
      </div>
    </div>
  </div>

  <script src="/static/dashboard_enhanced.js"></script>
</body>
</html>
